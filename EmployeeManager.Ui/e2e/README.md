# E2E Tests for Schedule Module

Цей каталог містить E2E тести для модуля графіка роботи, написані з використанням Playwright.

## Встановлення

Playwright вже встановлено як dev dependency. Якщо потрібно перевстановити:

```bash
npm install
npx playwright install chromium
```

## Запуск тестів

### Всі тести
```bash
npm run test:e2e
```

### З UI режимом (інтерактивний)
```bash
npm run test:e2e:ui
```

### У видимому браузері (headed mode)
```bash
npm run test:e2e:headed
```

### Конкретний тест
```bash
npx playwright test e2e/schedule.spec.ts
```

## Структура тестів

### `schedule.spec.ts`
Базові тести функціоналу:
- Відображення сторінки графіка
- Перемикач швидкого заповнення
- Вибір шаблонів (4, 8, 12 годин)
- Фільтрація по типах записів
- Перемикання між видами (день/тиждень)
- Навігація календаря
- Перевірка layout

### `schedule-advanced.spec.ts`
Розширені тести:
- Створення записів через швидкі шаблони
- Логіка нічних змін
- Запобігання множинним нотифікаціям
- Стабільність після змін фільтрів
- Швидке перемикання фільтрів
- Стан кнопок шаблонів
- Перемикання видів без втрати даних
- Адаптивний layout
- Обробка порожнього стану

## Що тестується

✅ **UI Компоненти:**
- Відображення календаря
- Панель швидких шаблонів
- Фільтри станів
- Кнопки навігації

✅ **Функціональність:**
- Перемикач швидкого заповнення
- Вибір шаблонів
- Фільтрація записів
- Перемикання видів календаря

✅ **Стабільність:**
- Відсутність помилок при взаємодії
- Відсутність безкінечних циклів
- Стабільність після змін фільтрів
- Правильна обробка порожнього стану

✅ **Layout:**
- Правильна ширина контейнера
- Висота календаря
- Адаптивність

## Налаштування

Конфігурація Playwright знаходиться в `playwright.config.ts`:
- Base URL: `http://localhost:4200`
- Браузер: Chromium
- Автоматичний запуск dev server перед тестами

## Результати тестів

Після запуску тестів:
- HTML звіт: `playwright-report/index.html`
- Скріншоти помилок: `test-results/`
- Трейси: `test-results/` (при помилках)

Відкрити HTML звіт:
```bash
npx playwright show-report
```

## Додавання нових тестів

При додаванні нових тестів:
1. Додайте тест у відповідний `.spec.ts` файл
2. Використовуйте описові назви тестів
3. Додайте `await page.waitForTimeout()` для стабільності
4. Перевіряйте стабільність календаря після дій

## Відомі обмеження

- Тести не створюють реальні записи в базі (потрібен mock API або тестова база)
- Drag & drop тестується тільки на рівні UI стану
- Повна перевірка нічних змін потребує реальних даних

## Troubleshooting

**Тести не запускаються:**
- Переконайтеся, що dev server запущено або використовується `webServer` в конфігурації
- Перевірте, що порт 4200 вільний

**Тести падають через таймаути:**
- Збільште `timeout` в `playwright.config.ts`
- Додайте більше `waitForTimeout` після важких операцій

**Календар не завантажується:**
- Перевірте, що API доступний
- Перевірте консоль браузера на помилки
